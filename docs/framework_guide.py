"""
GUIDE –¥–ª—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Python + Pytest + Selenium).
–°–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
–¶–µ–ª—å: –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–¥–∏–Ω—ã–π –∫–æ–¥-—Å—Ç–∞–π–ª –∏ —É—Å–∫–æ—Ä–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
"""


"""

# üèóÔ∏è Framework Guide - –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [1. –ë–∞–∑–æ–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã](#section-imports#L25)
- [1.2. –§–∏–∫—Å—Ç—É—Ä—ã Pytest](#section-fixtures#L54)  
- [1.3. Page Object Pattern](#section-pom)
- [2. –¢–∏–ø–∏—á–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ PYTHON –≤ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞—Ö](#section-patterns)
- [3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#section-architecture)
- [4. Conventional Commits](#section-commits)
- [5. –†–µ—à–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º](#section-troubleshooting)
"""


""" –†–ê–ó–î–ï–õ 1: –ë–ê–ó–û–í–´–ô –ö–ê–†–ö–ê–° –§–†–ï–ô–ú–í–û–†–ö–ê """

# ------------------------------------------------------------
# 1.1 –ë–ê–ó–û–í–´–ï –ò–ú–ü–û–†–¢–´
# ------------------------------------------------------------

# Selenium WebDriver
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import (TimeoutException, 
                                       NoSuchElementException,
                                       StaleElementReferenceException,
                                       ElementNotInteractableException)

# Pytest
import pytest

# API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
import requests
import json

# –£—Ç–∏–ª–∏—Ç—ã
from datetime import datetime
import time
import os
from typing import Dict, List, Optional, Any


# ------------------------------------------------------------
# 1.2. –§–ò–ö–°–¢–£–†–´ PYTEST
# ------------------------------------------------------------

import pytest
from selenium import webdriver

@pytest.fixture(scope="function")
def driver():
    driver = webdriver.Chrome()
    driver.implicitly_wait(5)  # –ù–µ—è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
    yield driver  # –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–¥–µ—Å—å
    driver.quit()  # –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞


# ------------------------------------------------------------
# 1.3. PAGE OBJECT PATTERN (–ë–ê–ó–û–í–ê–Ø –°–¢–†–ê–ù–ò–¶–ê)
# ------------------------------------------------------------

from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

class BasePage:
    def __init__(self, driver):
        self.driver = driver
        self.wait = WebDriverWait(driver, 10)  # –Ø–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ

    def find(self, locator):
        return self.driver.find_element(*locator)

    def wait_for_element(self, locator):
        """–ñ–¥–µ–º –ö–õ–ò–ö–ê–ë–ï–õ–¨–ù–û–°–¢–ò —ç–ª–µ–º–µ–Ω—Ç–∞"""
        return self.wait.until(EC.element_to_be_clickable(locator))

# ------------------------------------------------------------
# 1.4. –ü–†–ò–ú–ï–† –¢–ï–°–¢–ê
# ------------------------------------------------------------

# def test_login(driver):
#     page = LoginPage(driver)  # –í–∞—à –∫–ª–∞—Å—Å
#     page.login("username", "password")
#     assert page.is_logged_in()


"""
–†–ê–ó–î–ï–õ 2: –¢–ò–ü–ò–ß–ù–´–ï –ö–û–ù–°–¢–†–£–ö–¶–ò–ò PYTHON –í –ê–í–¢–û–¢–ï–°–¢–ê–•
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á QA.
"""

# ------------------------------------------------------------
# 2.1 –†–ê–ë–û–¢–ê –°–û –°–õ–û–í–ê–†–Ø–ú–ò (DICT): –ü–û–î–ì–û–¢–û–í–ö–ê –ò –ü–†–û–í–ï–†–ö–ê –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•
# ------------------------------------------------------------

from selenium.common.exceptions import NoSuchElementException

def merge_test_data(default_config, user_config):
    """
    –°–ª–∏—è–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π: –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ user_config –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç default_config.
    –¢–∏–ø–∏—á–Ω—ã–π —Å–ª—É—á–∞–π: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–∞ + —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–µ–π—Å–∞.
    """
    return {**default_config, **user_config}

def assert_dict_contains(expected_subset, actual_dict):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ actual_dict —Å–æ–¥–µ—Ä–∂–∏—Ç –í–°–ï –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ expected_subset.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ API –∏–ª–∏ –æ–±—ä–µ–∫—Ç–∞.
    """
    for key, expected_value in expected_subset.items():
        assert key in actual_dict, f"–ö–ª—é—á '{key}' –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ {actual_dict}"
        assert actual_dict[key] == expected_value, f"–ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–ª—é—á–∞ '{key}': –æ–∂–∏–¥–∞–ª–æ—Å—å {expected_value}, –ø–æ–ª—É—á–µ–Ω–æ {actual_dict[key]}"
    return True  # –ï—Å–ª–∏ –≤—Å–µ –∞—Å—Å–µ—Ä—Ç—ã –ø—Ä–æ—à–ª–∏

# ------------------------------------------------------------
# 2.2 –û–ë–†–ê–ë–û–¢–ö–ê –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô (TRY/EXCEPT/FINALLY): –î–ï–õ–ê–ï–ú –¢–ï–°–¢–´ –£–°–¢–û–ô–ß–ò–í–´–ú–ò
# ------------------------------------------------------------

def get_element_text_safe(driver, locator, default="–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"):
    """
    –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞. –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω,
    –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç default-–∑–Ω–∞—á–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞.
    –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.
    """
    try:
        return driver.find_element(*locator).text
    except NoSuchElementException:
        print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: —ç–ª–µ–º–µ–Ω—Ç {locator} –Ω–µ –Ω–∞–π–¥–µ–Ω. –í–æ–∑–≤—Ä–∞—â–∞—é default.")
        return default
    # –ë–ª–æ–∫ finally –∑–¥–µ—Å—å –Ω–µ –Ω—É–∂–µ–Ω, —Ç.–∫. –Ω–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

# –ö–õ–ê–°–°–ò–ß–ï–°–ö–ò–ô –ü–ê–¢–¢–ï–†–ù: –û–ß–ò–°–¢–ö–ê –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–• –í FINALLY
def test_create_and_delete_user(api_client):
    """
    –®–∞–±–ª–æ–Ω —Ç–µ—Å—Ç–∞, –≥–¥–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –õ–Æ–ë–û–ô –¶–ï–ù–û–ô,
    –¥–∞–∂–µ –µ—Å–ª–∏ —Å–∞–º —Ç–µ—Å—Ç —É–ø–∞–ª. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ—Ç—É –æ–∫—Ä—É–∂–µ–Ω–∏—è.
    """
    test_user = None
    try:
        # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
        test_user = api_client.create_user({"name": "Test"})
        user_id = test_user["id"]

        # 2. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∞
        fetched_user = api_client.get_user(user_id)
        assert fetched_user["name"] == "Test"

        # 3. –¢–µ—Å—Ç –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –∑–¥–µ—Å—å, –Ω–æ...
        # some_operation_that_might_fail()

    except AssertionError:
        # 4. ...—ç—Ç–æ—Ç –±–ª–æ–∫ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç –ø–∞–¥–µ–Ω–∏–µ –∞—Å—Å–µ—Ä—Ç–∞
        print("–¢–µ—Å—Ç —É–ø–∞–ª –Ω–∞ –∞—Å—Å–µ—Ä—Ç–µ, –Ω–æ –¥–∞–Ω–Ω—ã–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥—É—Ç –æ—á–∏—â–µ–Ω—ã")
        raise  # –ü–æ–¥–Ω–∏–º–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–Ω–æ–≤–∞, —á—Ç–æ–±—ã —Ç–µ—Å—Ç –±—ã–ª –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ —É–ø–∞–≤—à–∏–π
    except Exception as e:
        # 5. ...–∞ —ç—Ç–æ—Ç –±–ª–æ–∫ - –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
        print(f"–¢–µ—Å—Ç —É–ø–∞–ª —Å –æ—à–∏–±–∫–æ–π: {e}")
        raise
    finally:
        # 6. –í–´–ü–û–õ–ù–ò–¢–°–Ø –í–°–ï–ì–î–ê: –¥–∞–∂–µ –µ—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à—ë–ª, –¥–∞–∂–µ –µ—Å–ª–∏ —É–ø–∞–ª
        if test_user:
            print("–û—á–∏—Å—Ç–∫–∞: —É–¥–∞–ª—è—é —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
            api_client.delete_user(test_user["id"])

# ------------------------------------------------------------
# 2.3 –ò–¢–ï–†–ê–¶–ò–ò (FOR/IN): –ê–ù–ê–õ–ò–ó –ö–û–õ–õ–ï–ö–¶–ò–ô –í –¢–ï–°–¢–ê–•
# ------------------------------------------------------------

def check_all_items_in_list(actual_items, expected_items):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ expected_items –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ actual_items.
    –ß–∏—Ç–∞–µ–º–µ–µ, —á–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –∫–æ–≥–¥–∞ –≤–∞–∂–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –∏–ª–∏ –Ω—É–∂–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
    """
    missing_items = []
    for item in expected_items:
        if item not in actual_items:
            missing_items.append(item)
    
    assert not missing_items, f"–≠—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã: {missing_items}"
    return True

def find_failed_tests(test_results):
    """
    –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏: –æ—Ç–±–æ—Ä —Ç–æ–ª—å–∫–æ —É–ø–∞–≤—à–∏—Ö —Ç–µ—Å—Ç–æ–≤.
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ filter() –∏ list comprehension.
    """
    # –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ list comprehension (–ø–∏—Ç–æ–Ω–∏—á–Ω–æ –∏ —á–∏—Ç–∞–µ–º–æ)
    failed_listcomp = [test for test in test_results if test["status"] == "FAILED"]
    
    # –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ filter –∏ lambda (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å)
    failed_filter = list(filter(lambda test: test["status"] == "FAILED", test_results))
    
    # –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω —Å—Ç–∏–ª—å –∏ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å –µ–≥–æ
    return failed_listcomp


"""
–†–ê–ó–î–ï–õ 3: –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê –ò –ö–û–ù–í–ï–ù–¶–ò–ò
---------------------------------------------------------------
–¶–µ–ª—å: –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞.
–ó–∞—á–µ–º: –Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ (–∏–ª–∏ –≤—ã —á–µ—Ä–µ–∑ –º–µ—Å—è—Ü) —Å–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è.
"""

PROJECT_STRUCTURE = """
python-automation-practice/          # –ö–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ
‚îú‚îÄ‚îÄ .github/workflows/               # CI/CD: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ run-tests.yml               # –ü–∞—Ç—Ç–µ—Ä–Ω –∏–º–µ–Ω–∏: <—á—Ç–æ-–¥–µ–ª–∞–µ—Ç>.yml
‚îÇ
‚îú‚îÄ‚îÄ docs/                            # –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø (–Ω–µ –∫–æ–¥!)
‚îÇ   ‚îú‚îÄ‚îÄ framework_guide.py          # –≠—Ç–æ—Ç —Ñ–∞–π–ª. –ì–ª–∞–≤–Ω–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞.
‚îÇ   ‚îú‚îÄ‚îÄ decisions.md                # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ø–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ Pydantic?)
‚îÇ   ‚îî‚îÄ‚îÄ api_coverage.md             # –ö–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
‚îÇ
‚îú‚îÄ‚îÄ src/                             # –ò–°–•–û–î–ù–´–ô –ö–û–î —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ pages/                      # PAGE OBJECTS: –ø–æ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É/–ø–æ–ø–∞–ø
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py             # –î–µ–ª–∞–µ—Ç –ø–∞–ø–∫—É Python-–ø–∞–∫–µ—Ç–æ–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base_page.py            # BasePage —Å –æ–±—â–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ (find, click, wait)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login_page.py           # LoginPage(BasePage) - –Ω–∞—Å–ª–µ–¥—É–µ—Ç BasePage
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cart_page.py            # –°–æ–≥–ª–∞—à–µ–Ω–∏–µ: <name>_page.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/                        # API –ö–õ–ò–ï–ù–¢–´ –∏ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.py               # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å APIClient (—Å–∏–Ω–≥–ª—Ç–æ–Ω)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py               # Pydantic-–º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ endpoints/              # –û—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞, –µ—Å–ª–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –º–Ω–æ–≥–æ
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ auth_api.py         # AuthApi(APIClient) - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å /auth
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/                      # –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file_helpers.py         # read_json, write_csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wait_helpers.py         # custom_wait, click_first_enabled
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data_generators.py      # fake_email, random_string
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ config/                     # –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (–æ–∫—Ä—É–∂–µ–Ω–∏–µ, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ settings.py             # –ó–∞–≥—Ä—É–∂–∞–µ—Ç .env, –∑–∞–¥–∞—ë—Ç BASE_URL
‚îÇ       ‚îî‚îÄ‚îÄ constants.py            # TIMEouts, DEFAULT_USER, Colors
‚îÇ
‚îú‚îÄ‚îÄ tests/                          # –¢–ï–°–¢–´ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–¥ –∏–∑ src/)
‚îÇ   ‚îú‚îÄ‚îÄ ui/                         # UI-—Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_login.py          # –ü–∞—Ç—Ç–µ—Ä–Ω: test_<—Ñ–∏—á–∞>[_<–¥–µ—Ç–∞–ª—å>].py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_cart.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ smoke/                 # –ü–æ–¥–ø–∞–ø–∫–∞ –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞ @pytest.mark.smoke
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ test_smoke_ui.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/                        # API-—Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_user_crud.py      # CRUD = Create, Read, Update, Delete
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ conftest.py                 # –§–ò–ö–°–¢–£–†–´ PYTEST: –¥—Ä–∞–π–≤–µ—Ä, api_client
‚îÇ
‚îú‚îÄ‚îÄ data/                           # –¢–ï–°–¢–û–í–´–ï –î–ê–ù–ù–´–ï (–æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∫–æ–¥–∞)
‚îÇ   ‚îú‚îÄ‚îÄ users.json                 # –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ products.csv
‚îÇ   ‚îî‚îÄ‚îÄ schemas/                   # JSON-—Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API
‚îÇ       ‚îî‚îÄ‚îÄ user_schema.json
‚îÇ
‚îú‚îÄ‚îÄ reports/                        # –û–¢–ß–Å–¢–´ (–≤ .gitignore, —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ html/                       # pytest-html
‚îÇ   ‚îî‚îÄ‚îÄ allure-results/             # Allure
‚îÇ
‚îú‚îÄ‚îÄ .gitignore                     # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å reports/, .env, __pycache__/
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pytest, selenium, requests...
‚îú‚îÄ‚îÄ pytest.ini                     # –ö–æ–Ω—Ñ–∏–≥ pytest: –º–∞—Ä–∫–µ—Ä—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îú‚îÄ‚îÄ docker-compose.yml            # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
‚îî‚îÄ‚îÄ README.md                     # –í–∏–∑–∏—Ç–∫–∞: –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
"""

# ------------------------------------------------------------
# –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ù–í–ï–ù–¶–ò–ò –ò–ú–Å–ù (CODING CONVENTIONS)
# ------------------------------------------------------------

NAMING_RULES = """
–§–ê–ô–õ–´:
- Python-—Ñ–∞–π–ª—ã: –≤ snake_case (login_page.py, test_user_crud.py)
- –ü–∞–ø–∫–∏: –≤ snake_case (test_data, api_client)
- –¢–µ—Å—Ç—ã: –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å test_ (test_login_success, test_login_invalid_password)

–ö–õ–ê–°–°–´:
- Page Objects: <Name>Page (LoginPage, CartPage) - PascalCase
- API Clients: <Name>Client (AuthClient, UserClient) - PascalCase
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è: <Name>Error (ElementNotFoundError) - PascalCase

–ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –§–£–ù–ö–¶–ò–ò:
- –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: snake_case (user_name, timeout_seconds)
- —Ñ—É–Ω–∫—Ü–∏–∏: snake_case (click_element, read_config_file)
- –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã: UPPER_SNAKE_CASE (DEFAULT_TIMEOUT, BASE_URL)

–õ–û–ö–ê–¢–û–†–´ (–≤ Page Objects):
- –î–ª—è Selenium: <ELEMENT>_<TYPE> (USERNAME_INPUT, LOGIN_BUTTON, ERROR_SPAN)
- –î–ª—è Appium: –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å ANDROID_ –∏–ª–∏ IOS_ (ANDROID_LOGIN_BUTTON)

–§–ò–ö–°–¢–£–†–´ PYTEST:
- –ò–º—è = —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç (driver, api_client, chrome_options)
- scope: 'function' (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), 'class', 'module', 'session'
"""

# ------------------------------------------------------------
# –ß–¢–û –ö–£–î–ê –ö–õ–ê–°–¢–¨: –ë–´–°–¢–†–ê–Ø –°–ü–†–ê–í–ö–ê
# ------------------------------------------------------------

WHERE_TO_PUT = {
    "–ù–æ–≤—ã–π UI-—Ç–µ—Å—Ç –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã": "tests/ui/test_cart.py",
    "–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ '–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ' –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —á–∞—Ç–∞": "src/pages/chat_page.py",
    "–§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ email": "src/utils/data_generators.py",
    "–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î": "tests/conftest.py",
    "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Å URL staging-–æ–∫—Ä—É–∂–µ–Ω–∏—è": "src/config/constants.py",
    "–ú–æ–¥–µ–ª—å Pydantic –¥–ª—è –æ—Ç–≤–µ—Ç–∞ API –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è": "src/api/models.py",
    "JSON-—Å—Ö–µ–º–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–∞": "data/schemas/order_schema.json",
    "–ù–æ–≤—ã–π –º–∞—Ä–∫–µ—Ä pytest '@pytest.mark.slow'": "pytest.ini",
    "–®–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ Docker": "docker-compose.yml",
    "–û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞": "docs/decisions.md"
}

def explain_structure():
    """–ü–µ—á–∞—Ç–∞–µ—Ç –ø–æ—è—Å–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏)."""
    print("=" * 60)
    print("–°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò")
    print("=" * 60)
    print("\n1. src/ - –ö–û–î –§–†–ï–ô–ú–í–û–†–ö–ê (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π, –ª–æ–≥–∏–∫–∞)")
    print("   pages/    - Page Objects (–æ–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞)")
    print("   api/      - API –∫–ª–∏–µ–Ω—Ç—ã –∏ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö")
    print("   utils/    - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç–∞—Ç–∏—á–Ω—ã–µ)")
    print("   config/   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã")
    
    print("\n2. tests/ - –¢–ï–°–¢–´ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–¥ –∏–∑ src/)")
    print("   ui/      - UI-—Ç–µ—Å—Ç—ã (Selenium)")
    print("   api/     - API-—Ç–µ—Å—Ç—ã (requests)")
    print("   conftest.py - –§–∏–∫—Å—Ç—É—Ä—ã (–¥—Ä–∞–π–≤–µ—Ä, api_client)")
    
    print("\n3. data/ - –¢–ï–°–¢–û–í–´–ï –î–ê–ù–ù–´–ï (–æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∫–æ–¥–∞)")
    print("   *.json, *.csv - –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏")
    print("   schemas/ - JSON-—Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API")
    
    print("\n4. docs/ - –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø")
    print("   framework_guide.py - –≠—Ç–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞")
    print("   decisions.md - –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ —Ç—É –∏–ª–∏ –∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É")
    
    print("\n–ü–æ–ª–Ω—ã–π –ø—É—Ç—å —Å–º. –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PROJECT_STRUCTURE –≤—ã—à–µ.")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ:
if __name__ == "__main__":
    # –ú–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    explain_structure()     


"""
–†–ê–ó–î–ï–õ 4: Conventional Commits
---------------------------------------------------------------
–¶–µ–ª—å: –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞.
–ó–∞—á–µ–º: –Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ (–∏–ª–∏ –≤—ã —á–µ—Ä–µ–∑ –º–µ—Å—è—Ü) —Å–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è.
"""

"""
–ü—Ä–µ—Ñ–∏–∫—Å—ã (Conventional Commits):

feat: ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
fix: ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
docs: ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
build: ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–±–æ—Ä–∫–µ/—Å—Ç—Ä—É–∫—Ç—É—Ä–µ
refactor: ‚Äî —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
"""

""" –†–ê–ó–î–ï–õ 5: –ö–ê–ö –†–ï–®–ê–¢–¨ –û–ë–©–ò–ï –ü–†–û–ë–õ–ï–ú–´ """
# ----------------------------------------------
# –ü–†–û–ë–õ–ï–ú–ê: –≠–ª–µ–º–µ–Ω—Ç —É—Å—Ç–∞—Ä–µ–ª (StaleElementReferenceException)
# –†–ï–®–ï–ù–ò–ï: –ü–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞/–æ–∂–∏–¥–∞–Ω–∏—è
def safe_click(driver, locator):
    try:
        driver.find_element(*locator).click()
    except StaleElementReferenceException:
        # –ñ–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
        WebDriverWait(driver, 10).until(
            EC.element_to_be_clickable(locator)
        ).click()
